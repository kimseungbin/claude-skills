# Scope: Documentation
# LLM already decided type=docs from main.yaml type_decision_tree
# This file helps decide scope for documentation files

description: "Scope patterns for documentation files"

# When LLM reads this file:
# - Already determined commit type is docs
# - Changed files are .md files or documentation
# - Needs to decide appropriate documentation scope

# File path to scope mapping
file_path_patterns:
  # Project-level documentation
  CLAUDE.md: "project"
  README.md: "project"
  CONTRIBUTING.md: "project"
  CHANGELOG.md: "project"

  # Feature documentation
  docs/features/**: "features"
  docs/BACKLOG.md: "backlog"

  # Refactoring tasks
  docs/refactoring/**: "refactoring"

  # Implementation guides
  docs/ADDING_NEW_ENVIRONMENT.md: "project"
  docs/MAINTAINING_DOCUMENTATION.md: "project"
  docs/GIT_HOOKS_SETUP.md: "project"
  docs/DEPLOYMENT_APPROVAL_WORKFLOW.md: "project"
  docs/CDK_DIFF_EXPLAINED.md: "project"

  # Skill documentation
  .claude/skills/**/README.md: "skill"
  .claude/skills/**/SKILL.md: "skill"
  .claude/skills/**/*.md: "skill"
  .claude/config/*.md: "skill"

# Documentation scope patterns
project_scope:
  description: "Project-wide documentation"
  when_to_use:
    - "CLAUDE.md changes"
    - "README.md changes"
    - "Implementation guides"
    - "Architecture documentation"

  examples:
    - "docs(project): Update CLAUDE.md with construct hierarchy"
    - "docs(project): Add deployment troubleshooting guide"
    - "docs(project): Document git workflow"

  file_patterns:
    - "CLAUDE.md"
    - "README.md"
    - "docs/*.md (top-level guides)"

features_scope:
  description: "Feature documentation"
  when_to_use:
    - "Documenting new features"
    - "Feature specifications"
    - "Feature implementation status"

  examples:
    - "docs(features): Add two-phase deployment pattern"
    - "docs(features): Document QA environment setup"
    - "docs(features): Add cost optimization strategy"

  file_patterns:
    - "docs/features/**/*.md"

backlog_scope:
  description: "Backlog and task tracking"
  when_to_use:
    - "BACKLOG.md updates"
    - "Adding new tasks"
    - "Updating task status"

  examples:
    - "docs(backlog): Add Feature #18 for two-phase deployment"
    - "docs(backlog): Mark TODO-06 as completed"
    - "docs(backlog): Add refactoring task for ECR names"

  file_patterns:
    - "docs/BACKLOG.md"

refactoring_scope:
  description: "Refactoring task documentation"
  when_to_use:
    - "Refactoring task files"
    - "Task implementation notes"
    - "Task status updates"

  examples:
    - "docs(refactoring): Add TODO-06 ECR naming task"
    - "docs(refactoring): Update ARCH-04 implementation status"
    - "docs(refactoring): Document construct extraction pattern"

  file_patterns:
    - "docs/refactoring/**/*.md"

skill_scope:
  description: "Skill documentation (.claude/)"
  when_to_use:
    - "Skill README.md or SKILL.md"
    - "Skill configuration files"
    - "Skill templates or guides"

  examples:
    - "docs(skill): Add LLM reading scenarios to conventional-commits"
    - "docs(skill): Document pre-push hook rationale"
    - "docs(skill): Update cdk-expert Lambda patterns"

  file_patterns:
    - ".claude/skills/**/*.md"
    - ".claude/config/*.md"

# Decision tree for documentation scopes
scope_decision_tree:
  - question: "What documentation file changed?"
    claude_md: "project"
    readme_md: "project"
    features_dir: "features"
    backlog_md: "backlog"
    refactoring_dir: "refactoring"
    skills_dir: "skill"
    docs_toplevel: "project"

  - question: "Multiple documentation files changed?"
    same_scope: "Use that scope"
    different_scopes: "Consider separate commits"
    mixed_project_files: "Use project"

# Edge cases
edge_cases:
  - scenario: "Updating CLAUDE.md to reflect code changes"
    scope: "project"
    rationale: "CLAUDE.md is project-level documentation"
    example: "docs(project): Update CLAUDE.md with ServiceConstruct changes"

  - scenario: "Adding new feature documentation"
    scope: "features"
    rationale: "Feature-specific documentation"
    example: "docs(features): Add Feature #19 for cost anomaly detection"

  - scenario: "Updating backlog with completed tasks"
    scope: "backlog"
    rationale: "BACKLOG.md is task tracking"
    example: "docs(backlog): Mark TODO-06 as completed"

  - scenario: "Updating skill README"
    scope: "skill"
    rationale: "Skill-specific documentation"
    example: "docs(skill): Add usage examples to conventional-commits"

  - scenario: "Fixing typo in multiple doc files"
    scope: "project" (if project-level) or split commits
    rationale: "Typo fixes can be batched if same scope"
    example: "docs(project): Fix typos in README and CLAUDE.md"

# Multiple file changes
multi_file_patterns:
  - scenario: "CLAUDE.md + README.md"
    scope: "project"
    rationale: "Both are project-level"

  - scenario: "docs/features/planned/*.md (multiple files)"
    scope: "features"
    rationale: "All are feature documentation"

  - scenario: "CLAUDE.md + .claude/skills/*/README.md"
    scope: Split into two commits
    rationale: "Different scopes (project vs skill)"
    commits:
      - "docs(project): Update CLAUDE.md"
      - "docs(skill): Update skill README"

  - scenario: "docs/refactoring/high/*.md (multiple task files)"
    scope: "refactoring"
    rationale: "All are refactoring tasks"

# Special cases - inline documentation
inline_documentation:
  note: "Code files with documentation changes"

  jsdoc_comments:
    type: "refactor (not docs)"
    rationale: "JSDoc is code change"
    example: "refactor(service): Add JSDoc comments to ServiceConstruct"

  typo_in_comment:
    type: "docs (acceptable)"
    rationale: "Single-word typo fix is documentation"
    example: "docs(service): Fix typo in TaskDefinition comment"

  clarify_comment:
    type: "docs (if no code change)"
    rationale: "Comment clarification without code changes"
    example: "docs(config): Clarify ConfigService usage in comments"

# Documentation maintenance guidelines
maintenance_guidelines:
  commit_code_and_docs_separately:
    rule: "Keep documentation commits separate from code commits"
    example_workflow:
      - "1. Make code changes → commit as feat/fix/refactor"
      - "2. Update CLAUDE.md → commit as docs(project)"
    why: "Clearer git history, easier review"

  update_claude_md_promptly:
    rule: "Update CLAUDE.md when changing architecture"
    triggers:
      - "Adding new construct"
      - "Modifying stack structure"
      - "Changing configuration patterns"
      - "Adding new directories"

  use_maintaining_documentation_skill:
    note: "For systematic documentation updates, use maintaining-documentation skill"
    when: "After merging code changes that affect documentation"