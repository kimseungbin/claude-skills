# Guide: Title Patterns (Good vs Bad)
# LLM uses this to learn good commit title patterns

description: "Good and bad commit title patterns with explanations"

# When LLM reads this file:
# - Learning how to write good titles
# - Wants to see pattern comparison
# - Needs to understand why certain patterns are better

# Verb choice patterns
verb_patterns:
  adding_new_things:
    good:
      - "feat(service): Add auto-scaling support"
      - "feat(main): Add profile microservice"
      - "feat(cloudfront): Add WAF rate limiting"
    bad:
      - "feat(service): Implement auto-scaling"  # "Add" is clearer
      - "feat(main): Create profile service"  # "Add" is convention
      - "feat(cloudfront): Enable WAF"  # What aspect of WAF?
    principle: "Use 'Add' for new capabilities, be specific about what"

  fixing_bugs:
    good:
      - "fix(config): Correct memory limit for auth service"
      - "fix(cloudfront): Fix WAF rule priority causing blocks"
      - "fix(service): Resolve health check timeout issues"
    bad:
      - "fix(config): Update memory"  # Not clear it's a fix
      - "fix(cloudfront): Change WAF rules"  # Doesn't convey it's a fix
      - "fix(service): Health check"  # Missing verb
    principle: "Use verbs like 'Correct', 'Fix', 'Resolve' to convey bug fixing"

  refactoring:
    good:
      - "refactor(service): Extract ServiceInfraConstruct"
      - "refactor(config): Consolidate environment defaults"
      - "refactor(infra): Move constructs to packages/"
    bad:
      - "refactor(service): Update construct"  # What kind of update?
      - "refactor(config): Change configuration"  # Too vague
      - "refactor(infra): Reorganize"  # Reorganize what?
    principle: "Use specific verbs: Extract, Consolidate, Move, Rename"

  updating_docs:
    good:
      - "docs(project): Update CLAUDE.md with construct hierarchy"
      - "docs(features): Document two-phase deployment pattern"
      - "docs(backlog): Mark TODO-06 as completed"
    bad:
      - "docs(project): Update docs"  # Which docs?
      - "docs(features): Add documentation"  # Document what?
      - "docs(backlog): Update backlog"  # What update?
    principle: "Specify which documentation and what aspect"

# Naming patterns
naming_patterns:
  name_specific_components:
    good:
      - "feat(service): Add Redis cluster for session storage"
      - "fix(config): Correct memory limit for auth service"
      - "refactor(lambda): Extract message transformer logic"
    bad:
      - "feat(service): Add caching"  # What kind of caching?
      - "fix(config): Correct memory"  # For which service?
      - "refactor(lambda): Extract logic"  # Which logic?
    principle: "Name specific components, not generic categories"

  avoid_file_names:
    good:
      - "refactor(service): Extract ServiceInfraConstruct"
      - "feat(config): Add validation for Fargate CPU/memory"
      - "fix(cloudfront): Correct WAF rule configuration"
    bad:
      - "refactor(service): Update index.ts"  # File name, not component
      - "feat(config): Add validator.ts"  # File name, not functionality
      - "fix(cloudfront): Fix waf.ts"  # File name, not what was fixed
    principle: "Describe what the code does, not which file changed"

  service_vs_construct_scope:
    good:
      - "feat(auth): Add OAuth2 integration"  # Service-specific feature
      - "refactor(service): Extract ServiceInfraConstruct"  # Construct refactoring
      - "fix(config): Correct memory for auth service"  # Config change for specific service
    bad:
      - "feat(service): Add OAuth2 to auth"  # Should be feat(auth)
      - "refactor(auth): Extract ServiceConstruct"  # Should be refactor(service)
      - "fix(auth): Fix memory config"  # Should be fix(config)
    principle: "Use service name for service features, construct name for infrastructure"

# Infrastructure-specific patterns
infrastructure_patterns:
  microservices:
    good:
      - "feat(main): Add profile microservice"
      - "feat(main): Add QA environment deployment"
      - "fix(main): Correct service orchestration order"
    bad:
      - "feat(service): Add profile"  # Should be feat(main) for new service
      - "feat(qa): Add environment"  # Should be feat(main) for stack changes
      - "fix(service): Fix orchestration"  # Should be fix(main) for stack-level
    principle: "Use 'main' scope for stack-level orchestration, not 'service'"

  construct_changes:
    good:
      - "refactor(service): Extract ServiceInfraConstruct"
      - "feat(cloudfront): Add WAF rate limiting"
      - "fix(build): Correct CodeBuild environment injection"
    bad:
      - "refactor(main): Extract construct"  # Should specify construct name
      - "feat(waf): Add rate limiting"  # WAF is part of cloudfront
      - "fix(codebuild): Fix environment"  # Use 'build' scope
    principle: "Use construct scope (service, cloudfront, build) not AWS service names"

  configuration_changes:
    good:
      - "fix(config): Correct memory limit for auth service"
      - "refactor(config): Consolidate environment defaults"
      - "feat(types): Add Environment.QA enum"
    bad:
      - "fix(auth): Correct memory limit"  # Should be fix(config)
      - "refactor(main): Consolidate defaults"  # Should be refactor(config)
      - "feat(config): Add QA enum"  # Should be feat(types)
    principle: "Use 'config' for configuration data, 'types' for type definitions"

# Deployment-related patterns
deployment_patterns:
  pipeline_infrastructure:
    good:
      - "chore(deployment): Add Slack notifications for pipeline"
      - "chore(deployment): Implement deployment approval workflow"
      - "fix(deployment): Correct CodePipeline stage ordering"
    bad:
      - "feat(deployment): Add notifications"  # Should be chore for pipeline monitoring
      - "feat(main): Add approval workflow"  # Should be chore(deployment)
      - "fix(pipeline): Fix stage order"  # Use 'deployment' scope
    principle: "Use chore(deployment) for pipeline monitoring, not feat"

  tooling:
    good:
      - "chore(tools): Add git pre-push hooks"
      - "chore(tools): Add deployment analysis script"
      - "ci(github): Add deployment workflow"
    bad:
      - "feat(tools): Add hooks"  # Should be chore for tooling
      - "chore(scripts): Add analysis"  # Use 'tools' scope
      - "chore(github): Add workflow"  # Should be ci(github) for workflows
    principle: "Use chore(tools) for developer utilities, ci(github) for workflows"

# Body vs title patterns
what_belongs_in_title:
  title_should_have:
    - "What changed (Add/Fix/Extract/etc.)"
    - "Where it changed (scope)"
    - "Which component (specific name)"

  title_should_not_have:
    - "Why it changed (put in body)"
    - "How it works (put in body)"
    - "Implementation details (put in body)"

  examples:
    good_title: "refactor(service): Extract ServiceInfraConstruct"
    good_body: |
      Separate build infrastructure from runtime service for independent deployment cycles.

      - ServiceInfraConstruct: CodeBuild, ECR, pre-deployment setup
      - ServiceAppConstruct: ECS, ALB, CloudFront, application runtime

      Enables updating build infrastructure without redeploying services.

    bad_title: "refactor(service): Extract ServiceInfraConstruct because we need independent deployment"
    why_bad: "Rationale belongs in body, not title"

# Common anti-patterns
antipatterns:
  too_generic:
    examples:
      - "feat(main): Update code"
      - "fix(config): Fix configuration"
      - "refactor(service): Refactor construct"
      - "docs(project): Update documentation"
    why_bad: "Doesn't convey what was actually done"
    fix: "Add specific component names and actions"

  wrong_type:
    examples:
      - "feat(deployment): Add pipeline notifications"  # Should be chore
      - "docs(service): Add JSDoc comments"  # Should be refactor
      - "refactor(service): Add auto-scaling"  # Should be feat
    why_bad: "Type doesn't match the actual change"
    fix: "Use type decision tree in main.yaml"

  wrong_scope:
    examples:
      - "feat(service): Add profile microservice"  # Should be feat(main)
      - "fix(auth): Correct memory config"  # Should be fix(config)
      - "refactor(main): Extract construct"  # Should specify construct scope
    why_bad: "Scope doesn't match file changes"
    fix: "Use scope patterns in scopes/*.yaml"

  multiple_changes:
    examples:
      - "feat(main): Add service and update config and fix docs"
    why_bad: "One commit = one logical change"
    fix: "Split into 3 commits: feat(main), refactor(config), docs(project)"

  past_tense:
    examples:
      - "feat(service): Added auto-scaling"
      - "fix(config): Fixed memory limit"
      - "docs(project): Updated CLAUDE.md"
    why_bad: "Conventional commits use imperative mood"
    fix: "Add, Fix, Update (not Added, Fixed, Updated)"

# Quality indicators
quality_indicators:
  high_quality_title:
    characteristics:
      - "Specific component named"
      - "Action verb is precise (not generic)"
      - "Can understand change without reading body"
      - "Imperative mood"
      - "Appropriate scope for file changes"
    examples:
      - "feat(service): Add Redis cluster for session storage"
      - "refactor(service): Extract ServiceInfraConstruct for two-phase deployment"
      - "fix(cloudfront): Correct WAF rule priority causing blocks"

  low_quality_title:
    characteristics:
      - "Generic verbs (update, change, modify)"
      - "No component names"
      - "Requires reading body to understand"
      - "Past tense"
      - "Wrong type or scope"
    examples:
      - "feat(service): Update code"
      - "fix(config): Change configuration"
      - "refactor(main): Modified construct"