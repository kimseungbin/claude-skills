# Guide: Title Specificity and Quality Checklist
# LLM uses this to validate commit message quality

description: "Quality checklist for commit message titles"

# When LLM reads this file:
# - Already created commit message
# - Wants to validate quality before finalizing
# - Needs to check for specificity issues

# Specificity checklist
specificity_checklist:
  question_1:
    check: "Does the title name specific components/services?"
    good_examples:
      - "feat(service): Add auto-scaling support"
      - "fix(config): Correct memory limit for auth service"
      - "refactor(service): Extract ServiceInfraConstruct"
    bad_examples:
      - "feat(service): Update code"
      - "fix(config): Fix configuration"
      - "refactor(service): Refactor construct"
    why_bad: "Too vague, doesn't say WHAT was updated/fixed/refactored"

  question_2:
    check: "Does the title avoid generic verbs like 'update', 'change', 'modify'?"
    good_examples:
      - "feat(cloudfront): Add WAF rate limiting"
      - "fix(service): Correct health check path"
      - "refactor(config): Consolidate environment defaults"
    bad_examples:
      - "feat(cloudfront): Update WAF"
      - "fix(service): Change health check"
      - "refactor(config): Modify configuration"
    why_bad: "Generic verbs don't convey intent (add vs remove vs fix)"

  question_3:
    check: "Can you understand what changed without reading the body?"
    good_examples:
      - "feat(main): Add profile microservice"
      - "fix(cloudfront): Correct WAF rule priority causing blocks"
      - "chore(deployment): Add Slack notifications for pipeline"
    bad_examples:
      - "feat(main): Add service"
      - "fix(cloudfront): Fix rules"
      - "chore(deployment): Add notifications"
    why_bad: "Requires reading body to understand what was added/fixed"

  question_4:
    check: "Does the title specify which service/construct if multiple exist?"
    good_examples:
      - "fix(config): Correct memory limit for auth service"
      - "feat(service): Add Redis cluster support"
      - "refactor(lambda): Extract message transformer logic"
    bad_examples:
      - "fix(config): Correct memory limit"
      - "feat(service): Add caching"
      - "refactor(lambda): Extract logic"
    why_bad: "Multiple services/constructs exist, unclear which one"

  question_5:
    check: "Does the title use imperative mood (Add not Added, Fix not Fixed)?"
    good_examples:
      - "feat(service): Add auto-scaling"
      - "fix(config): Correct memory limit"
      - "docs(project): Update CLAUDE.md"
    bad_examples:
      - "feat(service): Added auto-scaling"
      - "fix(config): Corrected memory limit"
      - "docs(project): Updated CLAUDE.md"
    why_bad: "Conventional commits use imperative mood by convention"

# Length guidelines
length_guidelines:
  subject_line:
    max_length: 72
    ideal_length: 50-70
    why: "Git UI and terminal displays truncate long subjects"

  check_length:
    good_example: "feat(service): Add auto-scaling support"  # 42 chars
    acceptable: "refactor(service): Extract ServiceInfraConstruct for two-phase deployment"  # 75 chars
    too_long: "feat(service): Add auto-scaling support with CPU and memory targets and scale-in cooldown"  # 95 chars

# Common specificity issues
common_issues:
  vague_verbs:
    issue: "Using 'update', 'change', 'modify' without saying what changed"
    fix: "Use specific verbs: add, remove, correct, consolidate, extract, etc."
    examples:
      - bad: "update configuration"
      - good: "increase memory limit to 1024MB"

  missing_component_name:
    issue: "Not naming which service/construct was affected"
    fix: "Name specific components"
    examples:
      - bad: "Add caching"
      - good: "Add CloudFront caching for static assets"

  file_names_instead_of_components:
    issue: "Referencing file names instead of logical components"
    fix: "Name what the component does, not the file"
    examples:
      - bad: "Update index.ts"
      - good: "Extract ServiceInfraConstruct"

  multiple_changes_in_one_commit:
    issue: "Trying to describe 3+ unrelated changes in one title"
    fix: "Split into multiple commits or use generic scope"
    examples:
      - bad: "Update service, config, and documentation"
      - good: "Split into 3 commits: refactor(service), refactor(config), docs(project)"

# Improvement patterns
improvement_patterns:
  make_it_specific:
    before: "feat(service): Add caching"
    after: "feat(service): Add Redis cluster for session storage"
    improvement: "Specify what kind of caching and purpose"

  use_better_verbs:
    before: "fix(config): Update memory"
    after: "fix(config): Increase memory limit to 1024MB for auth service"
    improvement: "Specific verb (increase) and named component (auth service)"

  name_the_construct:
    before: "refactor(service): Refactor code"
    after: "refactor(service): Extract ServiceInfraConstruct for two-phase deployment"
    improvement: "Name what was extracted and why"

  add_context:
    before: "chore(deployment): Add notifications"
    after: "chore(deployment): Add Slack notifications for pipeline status"
    improvement: "Specify notification type and purpose"

# Quality score rubric (for LLM self-assessment)
quality_rubric:
  excellent: "5/5 specificity checks passed, clear and concise"
  good: "4/5 checks passed, minor improvements possible"
  acceptable: "3/5 checks passed, could be more specific"
  needs_improvement: "2/5 or fewer checks passed, vague or unclear"

  what_to_do:
    excellent: "Proceed with commit"
    good: "Proceed or suggest minor improvement"
    acceptable: "Suggest improvements before committing"
    needs_improvement: "Request rewrite with specific feedback"

# Infrastructure-specific guidance
infrastructure_titles:
  good_patterns:
    - "feat(main): Add profile microservice"
    - "refactor(service): Extract ServiceInfraConstruct"
    - "fix(cloudfront): Correct WAF rule priority causing blocks"
    - "chore(deployment): Add Slack notifications for pipeline"
    - "docs(project): Update CLAUDE.md with construct hierarchy"

  bad_patterns:
    - "feat(main): Add service"  # Which service?
    - "refactor(service): Update construct"  # What update?
    - "fix(cloudfront): Fix WAF"  # What was fixed?
    - "chore(deployment): Update pipeline"  # What was updated?
    - "docs(project): Update docs"  # Which docs?

# When to relax specificity
exceptions:
  trivial_changes:
    - "fix(config): Fix typo in comment"
    - "docs(project): Fix typo in README"
    - "chore(monorepo): Update .gitignore"
    reason: "Trivial changes don't need elaborate descriptions"

  obvious_from_scope:
    - "chore(deps): Update aws-cdk-lib to v2.100.0"
    - "ci(github): Add deployment workflow"
    reason: "Scope + type make intent clear"

  emergency_hotfixes:
    - "fix(lambda): Patch critical security vulnerability"
    reason: "Speed matters, details in body"